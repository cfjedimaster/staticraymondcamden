<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>Building a Twitter Search that highlights important tweets &middot; Raymond Camden</title>
    <meta name="generator" content="Hugo 0.15" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Raymond Camden">
    
      <meta name="description" content="">
    
	<link href="http://feeds.feedburner.com/raymondcamdensblog" rel="alternate" type="application/rss+xml" title="Raymond Camden" />
	<link href="http://feeds.feedburner.com/raymondcamdensblog" rel="feed" type="application/rss+xml" title="Raymond Camden" />
    <link rel="icon" href="http://www.raymondcamden.com/favicon.ico">
    <link rel="apple-touch-icon" href="http://www.raymondcamden.com/apple-touch-icon.png" />
    <link rel="stylesheet" href="http://www.raymondcamden.com/css/style.css">
    <link rel="stylesheet" href="http://www.raymondcamden.com/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://www.raymondcamden.com/css/monokai.css">
    <link rel="stylesheet" href="http://www.raymondcamden.com/fancybox/jquery.fancybox.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://www.raymondcamden.com/css/prism.css" />
	<link rel="stylesheet" href="http://www.raymondcamden.com/css/custom.css" />
	
    <meta property="og:title" content="Building a Twitter Search that highlights important tweets" />
<meta property="og:description" content="After spending some time arguing with an &ldquo;expert&rdquo; who made a comment about my favorite language without actually trying it, I thought it might be interesting to build a Twitter search tool that helps highlight &ldquo;important&rdquo; Tweets. I put &ldquo;important&rdquo; in quotes since there are many factors that might make one tweet more important compared to another. (And yes - I&rsquo;m sure this has been done. But darnit, when has that ever stopped me from coding before?) I decided to whip up a quick prototype and see how it works.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.raymondcamden.com/2011/11/21/Building-a-Twitter-Search-that-highlights-important-people" />


<meta property="og:updated_time" content="2011-11-21T12:11:00&#43;06:00"/>










    
    
<meta itemprop="name" content="Building a Twitter Search that highlights important tweets">
<meta itemprop="description" content="After spending some time arguing with an &ldquo;expert&rdquo; who made a comment about my favorite language without actually trying it, I thought it might be interesting to build a Twitter search tool that helps highlight &ldquo;important&rdquo; Tweets. I put &ldquo;important&rdquo; in quotes since there are many factors that might make one tweet more important compared to another. (And yes - I&rsquo;m sure this has been done. But darnit, when has that ever stopped me from coding before?) I decided to whip up a quick prototype and see how it works.
">


<meta itemprop="dateModified" content="2011-11-21T12:11:00&#43;06:00" />
<meta itemprop="wordCount" content="1662">



<meta itemprop="keywords" content="adoption,books,coldfusion,design,development,flex,games,html5,javascript,jquery,misc,mobile,movies,music,uncategorized,video-games,bluemix,cordova,front-end-interview-questions,harpjs,ionic,mobilefirst,nodejs,phonegap,strongloop,swift," />

    

  <meta name="twitter:card" content="summary"/>



<meta name="twitter:title" content="Building a Twitter Search that highlights important tweets"/>
<meta name="twitter:description" content="After spending some time arguing with an &ldquo;expert&rdquo; who made a comment about my favorite language without actually trying it, I thought it might be interesting to build a Twitter search tool that helps highlight &ldquo;important&rdquo; Tweets. I put &ldquo;important&rdquo; in quotes since there are many factors that might make one tweet more important compared to another. (And yes - I&rsquo;m sure this has been done. But darnit, when has that ever stopped me from coding before?) I decided to whip up a quick prototype and see how it works.
"/>
<meta name="twitter:site" content="@raymondcamden"/>


</head>
<body>
<div class="container">

<header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="http://www.raymondcamden.com/" id="logo"><i class="logo" style="background-image: url('http://www.raymondcamden.com/css/images/logo.png')"></i><span class="site-title">Raymond Camden</span></a>
      <nav id="main-nav">
          
          
          <a class="main-nav-link" href="http://www.raymondcamden.com/">Home</a>
          
          
          
          
          
          
          
          

          

          
          
          
          
          <a class="main-nav-link" href="http://www.raymondcamden.com/about/">About Me</a>
          
          
          
          <a class="main-nav-link" href="http://www.raymondcamden.com/speaking/">Speaking Engagements</a>
          
          
          
          <a class="main-nav-link" href="http://www.raymondcamden.com/contact/">Contact</a>
          
          
      </nav>
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="http://www.raymondcamden.com//images/avatar.jpg"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
        <div id="search-form-wrap">
          <form action="http://www.raymondcamden.com/search/" method="get" accept-charset="UTF-8" class="search-form">
              <input type="search" name="q" results="0" class="search-form-input" placeholder="Search">
              <button type="submit" class="search-form-submit">
              </button>
         </form>
        </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tbody>
          <tr>
          
          
          <td><a class="main-nav-link" href="http://www.raymondcamden.com/">Home</a></td>
          
          
          
          
          
          
          
          

          

          
          
          
          
          <td><a class="main-nav-link" href="http://www.raymondcamden.com/about/">About Me</a></td>
          
          
          
          <td><a class="main-nav-link" href="http://www.raymondcamden.com/speaking/">Speaking Engagements</a></td>
          
          
          
          <td><a class="main-nav-link" href="http://www.raymondcamden.com/contact/">Contact</a></td>
          
          
          <td>
          <form action="http://www.raymondcamden.com/search/" method="get" accept-charset="UTF-8" class="search-form">
          <input type="search" name="q" results="0" class="search-form-input" placeholder="Search">
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</header>


<div id="container">
   <div class="outer">
    <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="http://www.raymondcamden.com//images/avatar.jpg">
      <h2 id="name">Raymond Camden</h2>
      <h3 id="title">Developer Advocate for IBM</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Earth</span>
      
          <a id="follow" href="https://twitter.com/raymondcamden">
              Follow
          </a>
      
    </div>
    <div class="article-info profile-block">
	  
      <div class="article-info-block">
        5647
        <span>Posts</span>
      </div>
      <div class="article-info-block">
        
          10
          
        <span>
            Tags
        </span>
      </div>
	  
    </div>
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
<td><a href="//github.com/cfjedimaster" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>





















<td><a href="//youtube.com/theraymondcamden" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>





























<td><a href="//twitter.com/raymondcamden" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>


          <td><a href="http://feeds.feedburner.com/raymondcamdensblog" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></td>
        </tr>
      </table>
    </div>
  </div>


	<div class="widget-wrap">
		<div class="widget">

	<a href="http://www.slatwallcommerce.com/lp/coldfusion-ecommerce/?utm_source=Raymond%20Camden%20Blog&utm_medium=display&utm_content=Open%20Source%20ColdFusion%20eCommerce%20Platform&utm_campaign=ColdFusion%20eCommerce">
		<img src="/images/rcblog.png" class="centered">
	</a>
		</div>
	</div>

</aside>

    
<section id="main">
    <article id="page-undefined" class="article article-type-page" itemscope="" itemprop="blogPost">

		

		<p><a href="https://hostek.com/hosting/coldfusion/vps/coldfusion-vps-hosting.html">
			<img src="/images/ray-ad.jpg" class="centered" style="margin-bottom:10px">
		</a></p>

		

        <div class="article-inner">
            

            <header class="article-header">
    <a href="http://www.raymondcamden.com/2011/11/21/Building-a-Twitter-Search-that-highlights-important-people">
    <h1 class="article-title" itemprop="name">
        Building a Twitter Search that highlights important tweets
    </h1>
    </a>
    <div class="article-meta">
		
        <div class="article-date">
            <i class="fa fa-calendar"></i>
            <time datetime="2011-11-21 12:11:00 &#43;0600 &#43;0600" itemprop="datePublished">2011-11-21</time>
        </div>
		
        
        
            
            
            <div class="article-category">
                <i class="fa fa-folder"></i>
                
                <a class="article-category-link" href="http://www.raymondcamden.com/categories/html5">HTML5</a>
                &middot;
                
                <a class="article-category-link" href="http://www.raymondcamden.com/categories/javascript">JavaScript</a>
                &middot;
                
                <a class="article-category-link" href="http://www.raymondcamden.com/categories/jquery">jQuery</a>
                
                
            </div>
            
        

        
            
            
        
    </div>
</header>

            <div class="article-entry" itemprop="articleBody" style="padding-bottom:10px">
                <p>After spending some time arguing with an &ldquo;expert&rdquo; who made a comment about my favorite language without actually trying it, I thought it might be interesting to build a Twitter search tool that helps highlight &ldquo;important&rdquo; Tweets. I put &ldquo;important&rdquo; in quotes since there are many factors that might make one tweet more important compared to another. (And yes - I&rsquo;m sure this has been done. But darnit, when has that ever stopped me from coding before?) I decided to whip up a quick prototype and see how it works.</p>

<p><p></p>

<p>I began with a simple form. When you click, I take your result, hit the Twitter API, and render the results. Here&rsquo;s the code for the first draft.</p>

<p><p></p>

<p><code>
&lt;!DOCTYPE html&gt;
&lt;html&gt;</p>

<pre><code>&amp;lt;head&amp;gt;
&amp;lt;title&amp;gt;Twitter Search with Rating&amp;lt;/title&amp;gt;
&amp;lt;link rel=&quot;stylesheet&quot; href=&quot;bootstrap.min.css&quot;&amp;gt;
&amp;lt;script type=&quot;text/javascript&quot; src=&quot;http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script&amp;gt;
function getImportance(t){
    //First we check follower count
    //Then we check RT count
    //Then we check if the first part of the string is 'RT'
    var score=0;

    if(t.metadata.hasOwnProperty(&quot;recent_retweets&quot;)) score+= parseInt(t.metadata.recent_retweets);
    if(t.text.toLowerCase().indexOf(&quot;rt&quot;) == 0) score+=1;
    console.log(score);
    return score;
}

function renderTweet(t) {
    //console.log(JSON.stringify(t.metadata));
    var tweet = &quot;&quot;;
    var importance = getImportance(t);
    tweet += &quot;&amp;lt;p class='tweet &quot;+importance+&quot;'&amp;gt;&quot;;
    tweet += &quot;&amp;lt;img src='&quot;+t.profile_image_url+&quot;'&amp;gt;&quot;;
    tweet += &quot;From &quot;+t.from_user_name + &quot; on &quot;+t.created_at + &quot;&amp;lt;br/&amp;gt;&quot;;
    tweet += t.text+&quot;&amp;lt;/p&amp;gt;&quot;;
    return tweet;
}

$(document).ready(function() {

    $(&quot;#mainForm&quot;).submit(function(e) {
        $(&quot;#searchButton&quot;).trigger(&quot;click&quot;);
        e.preventDefault();
    });

    $(&quot;#searchButton&quot;).click(function() {
        var term = $.trim($(&quot;#searchterm&quot;).val());
        if(term == &quot;&quot;) return;
        console.log(&quot;Sarch for &quot;+term);
        $.getJSON(&quot;http://search.twitter.com/search.json?q=&quot;+escape(term)+&quot;&amp;lang=en&amp;include_entities=true&amp;rpp=100&amp;result_type=mixed&amp;callback=?&quot;, {}, function(res,code) {
            //console.dir(res.results);
            console.log(res.results.length + &quot; results.&quot;);
            var s = &quot;&quot;;
            for(var i=0; i&amp;lt;res.results.length; i++) {
                s+=renderTweet(res.results[i]);
            }
            $(&quot;#resultContainer&quot;).html(s);
        });
    }); 



})
&amp;lt;/script&amp;gt;
&amp;lt;style&amp;gt;
#resultContainer {
    height: 500px;
    overflow:auto;
    border-style:solid;
    border-width:thin;
}

.tweet {

}
.tweet img {
    align: left;
    padding-right: 10px;
}
&amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;

&amp;lt;body&amp;gt;

    &amp;lt;div class=&quot;container&quot;&amp;gt;

        &amp;lt;form id=&quot;mainForm&quot;&amp;gt;
            &amp;lt;fieldset&amp;gt;
            &amp;lt;div class=&quot;clearfix&quot;&amp;gt;
                &amp;lt;input type=&quot;text&quot; id=&quot;searchterm&quot; placeholder=&quot;Search Term&quot; class=&quot;xlarge&quot; size=&quot;30&quot;&amp;gt;
                &amp;lt;input type=&quot;button&quot; id=&quot;searchButton&quot; value=&quot;Search&quot; class=&quot;btn primary&quot;&amp;gt;
            &amp;lt;/div&amp;gt;
            &amp;lt;/fieldset&amp;gt;
        &amp;lt;/form&amp;gt;

        &amp;lt;div id=&quot;resultContainer&quot;&amp;gt;

        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;


&amp;lt;/body&amp;gt;
</code></pre>

<p>&lt;/html&gt;
</code></p>

<p><p></p>

<p>First take a look at the searchButton click handler. I grab the value out of the form and pass it to Twitter&rsquo;s API. For each result I&rsquo;m running a render function for the tweet. For the most part this is just vanilla HTML, but note the call out to getImportance. Sometimes Twitter will return metadata for a tweet noting how many times it has been retweeted. I take that and a possible &ldquo;RT&rdquo; in front and create a score from it. I&rsquo;m including it in the result HTML but not actually doing anything with it yet. Basically I just wanted to test the types of score values I get back. While Twitter returns the user ID and user name, it doesn&rsquo;t return any additional metadata for the user. I&rsquo;ll address that in the next draft.</p>

<p><p></p>

<p>Demo: <a href="http://www.raymondcamden.com/demos/2011/nov/21/searchwithrating.html">http://www.coldfusionjedi.com/demos/2011/nov/21/searchwithrating.html</a></p>

<p><p></p>

<p>Ok, now let&rsquo;s ramp it up a bit.</p>

<p><p></p>

<p><code>
&lt;!DOCTYPE html&gt;
&lt;html&gt;</p>

<pre><code>&amp;lt;head&amp;gt;
&amp;lt;title&amp;gt;Twitter Search with Rating&amp;lt;/title&amp;gt;
&amp;lt;link rel=&quot;stylesheet&quot; href=&quot;bootstrap.min.css&quot;&amp;gt;
&amp;lt;script type=&quot;text/javascript&quot; src=&quot;http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script&amp;gt;
var tweets = {};
var users = {};
var lookupusers = {};

//Credit: http://stackoverflow.com/questions/5223/length-of-javascript-associative-array/6700#6700
Object.size = function(obj) {
    var size = 0, key;
    for (key in obj) {
        if (obj.hasOwnProperty(key)) size++;
    }
    return size;
};

function getImportance(t){
    //First we check follower count
    //Then we check RT count
    //Then we check if the first part of the string is 'RT'
    var score=0;

    //first draft logic is 1 point per 1k followers
    score += Math.floor(users[t.from_user_id_str].followers_count/1000);
    if(t.metadata.hasOwnProperty(&quot;recent_retweets&quot;)) score+= parseInt(t.metadata.recent_retweets);
    if(t.text.toLowerCase().indexOf(&quot;rt&quot;) == 0) score+=1;

    //based on score return 3 levels of importance
    if(score &amp;lt; 10) return &quot;lowImportance&quot;;
    if(score &amp;lt; 25) return &quot;mediumImportance&quot;;
    return &quot;highImportance&quot;;
    return score;
}

function renderTweet(t) {
    //console.log(JSON.stringify(t.metadata));
    var tweet = &quot;&quot;;
    var importance = getImportance(t);
    tweet += &quot;&amp;lt;p class='tweet &quot;+importance +&quot;' id='&quot;+t.id+&quot;'&amp;gt;&quot;;
    tweet += &quot;&amp;lt;img src='&quot;+t.profile_image_url+&quot;'&amp;gt;&quot;;
    tweet += &quot;From &quot;+t.from_user_name + &quot; on &quot;+t.created_at + &quot;&amp;lt;br/&amp;gt;&quot;;
    tweet += t.text+&quot;&amp;lt;/p&amp;gt;&quot;;
    //console.log(tweet);
    return tweet;
}

function renderTweets(){
    var s = &quot;&quot;;
    for (var i = 0; i &amp;lt; tweets.length; i++) {
        s += renderTweet(tweets[i]);
    }
    $(&quot;#resultContainer&quot;).html(s);
}

$(document).ready(function() {

    $(&quot;#mainForm&quot;).submit(function(e) {
        $(&quot;#searchButton&quot;).trigger(&quot;click&quot;);
        e.preventDefault();
    });

    $(&quot;#searchButton&quot;).click(function() {
        var term = $.trim($(&quot;#searchterm&quot;).val());
        if(term == &quot;&quot;) return;
        $(&quot;#status&quot;).html(&quot;&amp;lt;i&amp;gt;Working....&amp;lt;/i&amp;gt;&quot;);
        lookupusers = {};
        console.log(&quot;Search for &quot;+term);
        $.getJSON(&quot;http://search.twitter.com/search.json?q=&quot;+escape(term)+&quot;&amp;lang=en&amp;include_entities=false&amp;rpp=100&amp;result_type=mixed&amp;callback=?&quot;, {}, function(res,code) {
            console.log(res.results.length + &quot; tweet results.&quot;);
            tweets = res.results;
            for(var i=0; i&amp;lt;res.results.length; i++) {
                if(!users.hasOwnProperty(res.results[i].from_user_id_str)) lookupusers[res.results[i].from_user_id_str] = 1;
            }
            //if we have lookup users, let's do the api call
            console.log(&quot;I need to look up &quot;+Object.size(lookupusers)+&quot; users.&quot;);
            var idlist = &quot;&quot;;
            for(var u in lookupusers) {
                idlist += u + &quot;,&quot;;
            }
            if(idlist != &quot;&quot;) {
                $.getJSON(&quot;https://api.twitter.com/1/users/lookup.json?user_id=&quot;+idlist+&quot;&amp;include_entities=false&amp;callback=?&quot;, {}, function(res, code) {
                    console.log(res.length + &quot; user results.&quot;);
                    //add everyone to the users cache
                    for(var i=0; i&amp;lt;res.length; i++) {
                        users[res[i].id] = res[i];
                    }
                    //then call render
                    $(&quot;#status&quot;).html(&quot;&quot;);
                    renderTweets();
                });
            } else {
                $(&quot;#status&quot;).html(&quot;&quot;);
                renderTweets();
            }
        });
    }); 



})
&amp;lt;/script&amp;gt;
&amp;lt;style&amp;gt;
#resultContainer {
    height: 500px;
    overflow:auto;
    border-style:solid;
    border-width:thin;
}

.tweet {

}
.tweet img {
    align: left;
    padding-right: 10px;
}
.lowImportance {
}
.mediumImportance {
    background-color: yellow;
}
.highImportance {
    background-color: red;
}
&amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;

&amp;lt;body&amp;gt;

    &amp;lt;div class=&quot;container&quot;&amp;gt;

        &amp;lt;form id=&quot;mainForm&quot;&amp;gt;
            &amp;lt;fieldset&amp;gt;
            &amp;lt;div class=&quot;clearfix&quot;&amp;gt;
                &amp;lt;input type=&quot;text&quot; id=&quot;searchterm&quot; placeholder=&quot;Search Term&quot; class=&quot;xlarge&quot; size=&quot;30&quot;&amp;gt;
                &amp;lt;input type=&quot;button&quot; id=&quot;searchButton&quot; value=&quot;Search&quot; class=&quot;btn primary&quot;&amp;gt; &amp;lt;span id=&quot;status&quot;&amp;gt;&amp;lt;/span&amp;gt;
            &amp;lt;/div&amp;gt;
            &amp;lt;/fieldset&amp;gt;
        &amp;lt;/form&amp;gt;

        &amp;lt;div id=&quot;resultContainer&quot;&amp;gt;

        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;


&amp;lt;/body&amp;gt;
</code></pre>

<p>&lt;/html&gt;
</code></p>

<p><p></p>

<p>Big changes here, so let me try to address each one in kind. First - notice that I&rsquo;ve got a global users object. The point of this is to cache user data. So if you search for jquery, for example, and then jquery ui, you may have the user info for a person&rsquo;s tweet already. The lookupusers object is going to be used as a way to track the people I need to look up (versus those I already have in cache).  Hop on down to the click handler. Now - I had thought about displaying the tweets after the search results, doing a user lookup, and then applying the styles when the data came back. You can see that a bit in the fact that I applied the tweet ID to the paragraph wrapping the display. I then discovered that the user look up system could take up to 100 people at once. That means that my network calls come down to just 2 per search. To me, that seemed like it would be fast enough to just make the user wait.</p>

<p><p></p>

<p>You can see then where I loop over the results and figure out which users I don&rsquo;t know. If I have any at all, I call a user request. If not, I immediately render them. The getImportance function now checks the user&rsquo;s follower count. It divides that by 1000 and adds it to the score. Not very scientific perhaps, but it&rsquo;s a demo. ;)</p>

<p><p></p>

<p>Demo - and note - this has bugs that we&rsquo;ll be addressing) - <a href="http://www.coldfusionjedi.com/demos/2011/nov/21/searchwithrating2.html">http://www.coldfusionjedi.com/demos/2011/nov/21/searchwithrating2.html</a></p>

<p><p></p>

<p>Ok - now for the third and final edition. I call this the epic version. In this version I make use of Session Storage. This is an HTML5 feature I&rsquo;ve talked about before (but I focused on Local Storage) that makes it really easy to store arbitrary data. I used Session Storage instead of Local Storage since I don&rsquo;t want to persist the data forever. Basically - I take user results, JSONify them, and put them in session. When the HTML page is loaded, if I have data there, I deserialize it. I also fixed a bug where Twitter was - for some reason - returning more than 100 tweets even though a) I asked just for a 100 and b) their docs say they only return 100. I also handled cases where user data for a particular user wasn&rsquo;t returned. (I&rsquo;m assuming it&rsquo;s a protected user.) Here&rsquo;s the latest code base:</p>

<p><p></p>

<p><code>
&lt;!DOCTYPE html&gt;
&lt;html&gt;</p>

<pre><code>&amp;lt;head&amp;gt;
&amp;lt;title&amp;gt;Twitter Search with Rating&amp;lt;/title&amp;gt;
&amp;lt;link rel=&quot;stylesheet&quot; href=&quot;bootstrap.min.css&quot;&amp;gt;
&amp;lt;script type=&quot;text/javascript&quot; src=&quot;http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script&amp;gt;
var tweets = {};
var users = {};
var lookupusers = {};

//Credit: http://stackoverflow.com/questions/5223/length-of-javascript-associative-array/6700#6700
Object.size = function(obj) {
    var size = 0, key;
    for (key in obj) {
        if (obj.hasOwnProperty(key)) size++;
    }
    return size;
};

function getImportance(t){
    //First we check follower count
    //Then we check RT count
    //Then we check if the first part of the string is 'RT'
    var score=0;

    //first draft logic is 1 point per 1k followers
    if (users.hasOwnProperty(t.from_user_id_str) &amp;&amp; users[t.from_user_id_str].hasOwnProperty(&quot;followers_count&quot;)) {
        score += Math.floor(users[t.from_user_id_str].followers_count / 1000);
    } 
    if(t.metadata.hasOwnProperty(&quot;recent_retweets&quot;)) score+= parseInt(t.metadata.recent_retweets);
    if(t.text.toLowerCase().indexOf(&quot;rt&quot;) == 0) score+=1;

    //based on score return 3 levels of importance
    if(score &amp;lt; 10) return &quot;lowImportance&quot;;
    if(score &amp;lt; 25) return &quot;mediumImportance&quot;;
    return &quot;highImportance&quot;;
    return score;
}

function renderTweet(t) {
    //console.log(JSON.stringify(t.metadata));
    var tweet = &quot;&quot;;
    var importance = getImportance(t);
    tweet += &quot;&amp;lt;p class='tweet &quot;+importance +&quot;' id='&quot;+t.id+&quot;'&amp;gt;&quot;;
    tweet += &quot;&amp;lt;img src='&quot;+t.profile_image_url+&quot;'&amp;gt;&quot;;
    tweet += &quot;From &quot;+t.from_user_name + &quot; on &quot;+t.created_at + &quot;&amp;lt;br/&amp;gt;&quot;;
    tweet += t.text+&quot;&amp;lt;/p&amp;gt;&quot;;
    //console.log(tweet);
    return tweet;
}

function renderTweets(){
    var s = &quot;&quot;;
    for (var i = 0; i &amp;lt; tweets.length; i++) {
        s += renderTweet(tweets[i]);
    }
    $(&quot;#resultContainer&quot;).html(s);
}

$(document).ready(function() {

    //if we have users in sessionstore, load em 
    if(sessionStorage.hasOwnProperty(&quot;users&quot;)) {
        console.log(&quot;good news, I have users already&quot;);
        users = JSON.parse(sessionStorage[&quot;users&quot;]);
        console.log(&quot;I preloaded &quot;+Object.size(users)+ &quot; users.&quot;);
        console.dir(users);
    } 

    $(&quot;#mainForm&quot;).submit(function(e) {
        $(&quot;#searchButton&quot;).trigger(&quot;click&quot;);
        e.preventDefault();
    });

    $(&quot;#searchButton&quot;).click(function() {
        var term = $.trim($(&quot;#searchterm&quot;).val());
        if(term == &quot;&quot;) return;
        $(&quot;#status&quot;).html(&quot;&amp;lt;i&amp;gt;Working....&amp;lt;/i&amp;gt;&quot;);
        $(&quot;#resultContainer&quot;).html(&quot;&quot;);
        lookupusers = {};
        console.log(&quot;Search for &quot;+term);
        $.getJSON(&quot;http://search.twitter.com/search.json?q=&quot;+escape(term)+&quot;&amp;lang=en&amp;include_entities=false&amp;rpp=100&amp;result_type=mixed&amp;callback=?&quot;, {}, function(res,code) {
            console.log(res.results.length + &quot; tweet results.&quot;);
            tweets = res.results;
            for(var i=0; i&amp;lt;Math.min(100,res.results.length); i++) {
                if(!users.hasOwnProperty(res.results[i].from_user_id_str)) lookupusers[res.results[i].from_user_id_str] = 1;
            }
            //if we have lookup users, let's do the api call
            console.log(&quot;I need to look up &quot;+Object.size(lookupusers)+&quot; users.&quot;);
            var idlist = &quot;&quot;;
            for(var u in lookupusers) {
                idlist += u + &quot;,&quot;;
            }
            if(idlist != &quot;&quot;) {
                $.getJSON(&quot;https://api.twitter.com/1/users/lookup.json?user_id=&quot;+idlist+&quot;&amp;include_entities=false&amp;callback=?&quot;, {}, function(res, code) {
                    console.log(res.length + &quot; user results.&quot;);
                    //add everyone to the users cache
                    for(var i=0; i&amp;lt;res.length; i++) {
                        users[res[i].id] = res[i];
                    }
                    //copy to session
                    sessionStorage[&quot;users&quot;] = JSON.stringify(users);
                    //then call render
                    $(&quot;#status&quot;).html(&quot;&quot;);
                    renderTweets();
                });
            } else {
                $(&quot;#status&quot;).html(&quot;&quot;);
                renderTweets();
            }
        });
    }); 



})
&amp;lt;/script&amp;gt;
&amp;lt;style&amp;gt;
#resultContainer {
    height: 500px;
    overflow:auto;
    border-style:solid;
    border-width:thin;
}

.tweet {

}
.tweet img {
    align: left;
    padding-right: 10px;
}
.lowImportance {
}
.mediumImportance {
    background-color: yellow;
}
.highImportance {
    background-color: red;
}
&amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;

&amp;lt;body&amp;gt;

    &amp;lt;div class=&quot;container&quot;&amp;gt;

        &amp;lt;form id=&quot;mainForm&quot;&amp;gt;
            &amp;lt;fieldset&amp;gt;
            &amp;lt;div class=&quot;clearfix&quot;&amp;gt;
                &amp;lt;input type=&quot;text&quot; id=&quot;searchterm&quot; placeholder=&quot;Search Term&quot; class=&quot;xlarge&quot; size=&quot;30&quot;&amp;gt;
                &amp;lt;input type=&quot;button&quot; id=&quot;searchButton&quot; value=&quot;Search&quot; class=&quot;btn primary&quot;&amp;gt; &amp;lt;span id=&quot;status&quot;&amp;gt;&amp;lt;/span&amp;gt;
            &amp;lt;/div&amp;gt;
            &amp;lt;/fieldset&amp;gt;
        &amp;lt;/form&amp;gt;

        &amp;lt;div id=&quot;resultContainer&quot;&amp;gt;

        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;


&amp;lt;/body&amp;gt;
</code></pre>

<p>&lt;/html&gt;
</code></p>

<p><p></p>

<p>And here is a sample. Yes, the red is horrible. I know.</p>

<p><p></p>

<p><img src="http://www.coldfusionjedi.com/images/ScreenClip236.png" /></p>

<p><p></p>

<p>You can demo this one here: <a href="http://www.coldfusionjedi.com/demos/2011/nov/21/searchwithrating3.html">http://www.coldfusionjedi.com/demos/2011/nov/21/searchwithrating3.html</a></p>

            </div>
        </div>

    </article>

		
    <section id="comments">
        <div id="disqus_thread">
            
<script>
var disqus_config = function () {

this.page.url = 'http://www.raymondcamden.com\/2011\/11\/21\/Building-a-Twitter-Search-that-highlights-important-people'; 
this.page.identifier = '/?p=4441'; 

};

(function() { 
var d = document, s = d.createElement('script');

s.src = '//raymondcamden.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        </div>
    </section>
	
</section>

    <aside id="sidebar">

	<div class="widget-wrap">
		<h3 class="widget-title">
			Sponsors
		</h3>
		<div class="widget">
			<a href="http://www.fusion-reactor.com/?affiliate=raymondcamden"><img src="/images/frad150.png" title="FusionReactor"></a>
		</div>
	</div>

  	
    
<div class="widget-wrap">
    <h3 class="widget-title">
        Recents
    </h3>
    <div class="widget">
        <ul id="recent-post">
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.raymondcamden.com/2011/11/21/Building-a-Twitter-Search-that-highlights-important-people" class="thumbnail">
                    
                        <span style="background-image:url(http://www.raymondcamden.com//images/banners/comicbooks.jpg)" alt="Building a Twitter Search that highlights important tweets" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://www.raymondcamden.com/categories/development">
                        Development
                        </a>
                    </p>
                    
                    <p class="item-title"><a href="http://www.raymondcamden.com/2016/02/22/building-a-twitter-bot-to-display-random-comic-book-covers" class="title">Building a Twitter bot to display random comic book covers</a></p>
                    <p class="item-date">
                        <time datetime="2016-02-22 10:42:00 -0700 -0700" itemprop="datePublished">2016-02-22</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.raymondcamden.com/2011/11/21/Building-a-Twitter-Search-that-highlights-important-people" class="thumbnail">
                    
                        <span class="thumbnail-image thumbnail-none"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://www.raymondcamden.com/categories/development">
                        Development
                        </a>
                    </p>
                    
                    <p class="item-title"><a href="http://www.raymondcamden.com/2016/02/18/creating-an-unread-count-for-a-static-site" class="title">Creating an unread count for a static site</a></p>
                    <p class="item-date">
                        <time datetime="2016-02-18 14:23:00 -0700 -0700" itemprop="datePublished">2016-02-18</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.raymondcamden.com/2011/11/21/Building-a-Twitter-Search-that-highlights-important-people" class="thumbnail">
                    
                        <span style="background-image:url(http://www.raymondcamden.com//images/banners/phonegap-logo.png)" alt="Building a Twitter Search that highlights important tweets" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://www.raymondcamden.com/categories/development">
                        Development
                        </a>
                    </p>
                    
                    <p class="item-title"><a href="http://www.raymondcamden.com/2016/02/17/my-phonegap-day-2016-presentation" class="title">My PhoneGap Day 2016 Presentation</a></p>
                    <p class="item-date">
                        <time datetime="2016-02-17 08:41:00 -0700 -0700" itemprop="datePublished">2016-02-17</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.raymondcamden.com/2011/11/21/Building-a-Twitter-Search-that-highlights-important-people" class="thumbnail">
                    
                        <span class="thumbnail-image thumbnail-none"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://www.raymondcamden.com/categories/coldfusion">
                        ColdFusion
                        </a>
                    </p>
                    
                    <p class="item-title"><a href="http://www.raymondcamden.com/2016/02/16/adobe-coldfusion-2016-released" class="title">Adobe ColdFusion 2016 Released</a></p>
                    <p class="item-date">
                        <time datetime="2016-02-16 05:35:00 -0700 -0700" itemprop="datePublished">2016-02-16</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.raymondcamden.com/2011/11/21/Building-a-Twitter-Search-that-highlights-important-people" class="thumbnail">
                    
                        <span class="thumbnail-image thumbnail-none"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://www.raymondcamden.com/categories/misc">
                        Misc
                        </a>
                    </p>
                    
                    <p class="item-title"><a href="http://www.raymondcamden.com/2016/02/15/missing-devnexus" class="title">Missing DevNexus</a></p>
                    <p class="item-date">
                        <time datetime="2016-02-15 14:44:00 -0700 -0700" itemprop="datePublished">2016-02-15</time>
                    </p>
                </div>
            </li>
            
        </ul>
    </div>
</div>


    


<div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/adoption">
                    adoption
                </a>
                <span class="category-list-count">13</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/books">
                    books
                </a>
                <span class="category-list-count">39</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/coldfusion">
                    coldfusion
                </a>
                <span class="category-list-count">3128</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/design">
                    design
                </a>
                <span class="category-list-count">32</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/development">
                    development
                </a>
                <span class="category-list-count">706</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/flex">
                    flex
                </a>
                <span class="category-list-count">189</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/games">
                    games
                </a>
                <span class="category-list-count">5</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/html5">
                    html5
                </a>
                <span class="category-list-count">273</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/javascript">
                    javascript
                </a>
                <span class="category-list-count">592</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/jquery">
                    jquery
                </a>
                <span class="category-list-count">329</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/misc">
                    misc
                </a>
                <span class="category-list-count">1157</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/mobile">
                    mobile
                </a>
                <span class="category-list-count">458</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/movies">
                    movies
                </a>
                <span class="category-list-count">31</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/music">
                    music
                </a>
                <span class="category-list-count">10</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/uncategorized">
                    uncategorized
                </a>
                <span class="category-list-count">13</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/video-games">
                    video-games
                </a>
                <span class="category-list-count">74</span>
            </li>
            
        </ul>
    </div>
</div>



    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tags
    </h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/bluemix">
                    bluemix
                </a>
                <span class="category-list-count">21</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/cordova">
                    cordova
                </a>
                <span class="category-list-count">51</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/front-end-interview-questions">
                    front-end-interview-questions
                </a>
                <span class="category-list-count">3</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/harpjs">
                    harpjs
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/ionic">
                    ionic
                </a>
                <span class="category-list-count">66</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/mobilefirst">
                    mobilefirst
                </a>
                <span class="category-list-count">25</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/nodejs">
                    nodejs
                </a>
                <span class="category-list-count">3</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/phonegap">
                    phonegap
                </a>
                <span class="category-list-count">2</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/strongloop">
                    strongloop
                </a>
                <span class="category-list-count">10</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/swift">
                    swift
                </a>
                <span class="category-list-count">1</span>
            </li>
            
        </ul>
    </div>
</div>



    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tag cloud
    </h3>
    <div class="widget tagcloud">
        
        <a href="http://www.raymondcamden.com/tags/bluemix" style="font-size: 12px;">bluemix</a>
        
        <a href="http://www.raymondcamden.com/tags/cordova" style="font-size: 12px;">cordova</a>
        
        <a href="http://www.raymondcamden.com/tags/front-end-interview-questions" style="font-size: 12px;">front-end-interview-questions</a>
        
        <a href="http://www.raymondcamden.com/tags/harpjs" style="font-size: 12px;">harpjs</a>
        
        <a href="http://www.raymondcamden.com/tags/ionic" style="font-size: 12px;">ionic</a>
        
        <a href="http://www.raymondcamden.com/tags/mobilefirst" style="font-size: 12px;">mobilefirst</a>
        
        <a href="http://www.raymondcamden.com/tags/nodejs" style="font-size: 12px;">nodejs</a>
        
        <a href="http://www.raymondcamden.com/tags/phonegap" style="font-size: 12px;">phonegap</a>
        
        <a href="http://www.raymondcamden.com/tags/strongloop" style="font-size: 12px;">strongloop</a>
        
        <a href="http://www.raymondcamden.com/tags/swift" style="font-size: 12px;">swift</a>
        
    </div>
</div>



	

    <div id="toTop" class="fa fa-chevron-up"></div>
</aside>

</div>
</div>

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016
      Powered by <a href="//gohugo.io">Hugo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>.
    </div>
  </div>
</footer>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-70863-1', 'auto');
ga('send', 'pageview');
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="http://www.raymondcamden.com/fancybox/jquery.fancybox.pack.js"></script>
<script src="http://www.raymondcamden.com/js/script.js"></script>
<script src="http://www.raymondcamden.com/js/prism.js"></script>


</body>
</html>
