<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>Follow up to CFMAP/jQuery/911 Demo &middot; Raymond Camden</title>
    <meta name="generator" content="Hugo 0.15" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Raymond Camden">
    
      <meta name="description" content="">
    
	<link href="http://feeds.feedburner.com/raymondcamdensblog" rel="alternate" type="application/rss+xml" title="Raymond Camden" />
	<link href="http://feeds.feedburner.com/raymondcamdensblog" rel="feed" type="application/rss+xml" title="Raymond Camden" />
    <link rel="icon" href="http://www.raymondcamden.com/favicon.ico">
    <link rel="apple-touch-icon" href="http://www.raymondcamden.com/apple-touch-icon.png" />
    <link rel="stylesheet" href="http://www.raymondcamden.com/css/style.css">
    <link rel="stylesheet" href="http://www.raymondcamden.com/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://www.raymondcamden.com/css/monokai.css">
    <link rel="stylesheet" href="http://www.raymondcamden.com/fancybox/jquery.fancybox.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://www.raymondcamden.com/css/prism.css" />
	<link rel="stylesheet" href="http://www.raymondcamden.com/css/custom.css" />
	
    <meta property="og:title" content="Follow up to CFMAP/jQuery/911 Demo" />
<meta property="og:description" content="Yesterday I blogged about a proof of concept 911 viewer I built using CFMap and jQuery. The first example simply retrieved all of the 911 reports and mapped them at once. The second demo was more complex. This demo actually showed you map data from the beginning of the collection to the most recent report. Watch the video if that doesn&rsquo;t make sense. Let&rsquo;s look at how I built that demo. (Warning: I&rsquo;m going to jump around a bit code wise but at the end I&rsquo;ll paste the entire template.)
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.raymondcamden.com/2010/01/20/Follow-up-to-CFMAPjQuery911-Demo" />


<meta property="og:updated_time" content="2010-01-20T18:01:00&#43;06:00"/>










    
    
<meta itemprop="name" content="Follow up to CFMAP/jQuery/911 Demo">
<meta itemprop="description" content="Yesterday I blogged about a proof of concept 911 viewer I built using CFMap and jQuery. The first example simply retrieved all of the 911 reports and mapped them at once. The second demo was more complex. This demo actually showed you map data from the beginning of the collection to the most recent report. Watch the video if that doesn&rsquo;t make sense. Let&rsquo;s look at how I built that demo. (Warning: I&rsquo;m going to jump around a bit code wise but at the end I&rsquo;ll paste the entire template.)
">


<meta itemprop="dateModified" content="2010-01-20T18:01:00&#43;06:00" />
<meta itemprop="wordCount" content="1205">



<meta itemprop="keywords" content="adoption,books,coldfusion,design,development,flex,games,html5,javascript,jquery,misc,mobile,movies,music,uncategorized,video-games,bluemix,cordova,front-end-interview-questions,harpjs,ionic,mobilefirst,nodejs,phonegap,strongloop,swift," />

    

  <meta name="twitter:card" content="summary"/>



<meta name="twitter:title" content="Follow up to CFMAP/jQuery/911 Demo"/>
<meta name="twitter:description" content="Yesterday I blogged about a proof of concept 911 viewer I built using CFMap and jQuery. The first example simply retrieved all of the 911 reports and mapped them at once. The second demo was more complex. This demo actually showed you map data from the beginning of the collection to the most recent report. Watch the video if that doesn&rsquo;t make sense. Let&rsquo;s look at how I built that demo. (Warning: I&rsquo;m going to jump around a bit code wise but at the end I&rsquo;ll paste the entire template.)
"/>
<meta name="twitter:site" content="@raymondcamden"/>


</head>
<body>
<div class="container">

<header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="http://www.raymondcamden.com/" id="logo"><i class="logo" style="background-image: url('http://www.raymondcamden.com/css/images/logo.png')"></i><span class="site-title">Raymond Camden</span></a>
      <nav id="main-nav">
          
          
          <a class="main-nav-link" href="http://www.raymondcamden.com/">Home</a>
          
          
          
          
          
          
          
          

          

          
          
          
          
          <a class="main-nav-link" href="http://www.raymondcamden.com/about/">About Me</a>
          
          
          
          <a class="main-nav-link" href="http://www.raymondcamden.com/speaking/">Speaking Engagements</a>
          
          
          
          <a class="main-nav-link" href="http://www.raymondcamden.com/contact/">Contact</a>
          
          
      </nav>
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="http://www.raymondcamden.com//images/avatar.jpg"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
        <div id="search-form-wrap">
          <form action="http://www.raymondcamden.com/search/" method="get" accept-charset="UTF-8" class="search-form">
              <input type="search" name="q" results="0" class="search-form-input" placeholder="Search">
              <button type="submit" class="search-form-submit">
              </button>
         </form>
        </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tbody>
          <tr>
          
          
          <td><a class="main-nav-link" href="http://www.raymondcamden.com/">Home</a></td>
          
          
          
          
          
          
          
          

          

          
          
          
          
          <td><a class="main-nav-link" href="http://www.raymondcamden.com/about/">About Me</a></td>
          
          
          
          <td><a class="main-nav-link" href="http://www.raymondcamden.com/speaking/">Speaking Engagements</a></td>
          
          
          
          <td><a class="main-nav-link" href="http://www.raymondcamden.com/contact/">Contact</a></td>
          
          
          <td>
          <form action="http://www.raymondcamden.com/search/" method="get" accept-charset="UTF-8" class="search-form">
          <input type="search" name="q" results="0" class="search-form-input" placeholder="Search">
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</header>


<div id="container">
   <div class="outer">
    <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="http://www.raymondcamden.com//images/avatar.jpg">
      <h2 id="name">Raymond Camden</h2>
      <h3 id="title">Developer Advocate for IBM</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Earth</span>
      
          <a id="follow" href="https://twitter.com/raymondcamden">
              Follow
          </a>
      
    </div>
    <div class="article-info profile-block">
	  
      <div class="article-info-block">
        5647
        <span>Posts</span>
      </div>
      <div class="article-info-block">
        
          10
          
        <span>
            Tags
        </span>
      </div>
	  
    </div>
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
<td><a href="//github.com/cfjedimaster" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>





















<td><a href="//youtube.com/theraymondcamden" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>





























<td><a href="//twitter.com/raymondcamden" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>


          <td><a href="http://feeds.feedburner.com/raymondcamdensblog" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></td>
        </tr>
      </table>
    </div>
  </div>


	<div class="widget-wrap">
		<div class="widget">

	<a href="http://www.slatwallcommerce.com/lp/coldfusion-ecommerce/?utm_source=Raymond%20Camden%20Blog&utm_medium=display&utm_content=Open%20Source%20ColdFusion%20eCommerce%20Platform&utm_campaign=ColdFusion%20eCommerce">
		<img src="/images/rcblog.png" class="centered">
	</a>
		</div>
	</div>

</aside>

    
<section id="main">
    <article id="page-undefined" class="article article-type-page" itemscope="" itemprop="blogPost">

		

		<p><a href="https://hostek.com/hosting/coldfusion/vps/coldfusion-vps-hosting.html">
			<img src="/images/ray-ad.jpg" class="centered" style="margin-bottom:10px">
		</a></p>

		

        <div class="article-inner">
            

            <header class="article-header">
    <a href="http://www.raymondcamden.com/2010/01/20/Follow-up-to-CFMAPjQuery911-Demo">
    <h1 class="article-title" itemprop="name">
        Follow up to CFMAP/jQuery/911 Demo
    </h1>
    </a>
    <div class="article-meta">
		
        <div class="article-date">
            <i class="fa fa-calendar"></i>
            <time datetime="2010-01-20 18:01:00 &#43;0600 &#43;0600" itemprop="datePublished">2010-01-20</time>
        </div>
		
        
        
            
            
            <div class="article-category">
                <i class="fa fa-folder"></i>
                
                <a class="article-category-link" href="http://www.raymondcamden.com/categories/coldfusion">ColdFusion</a>
                &middot;
                
                <a class="article-category-link" href="http://www.raymondcamden.com/categories/jquery">jQuery</a>
                
                
            </div>
            
        

        
            
            
        
    </div>
</header>

            <div class="article-entry" itemprop="articleBody" style="padding-bottom:10px">
                <p>Yesterday I <a href="http://www.raymondcamden.com/index.cfm/2010/1/19/Proof-of-Concept-911-Viewer">blogged</a> about a proof of concept 911 viewer I built using CFMap and jQuery. The first example simply retrieved all of the 911 reports and mapped them at once. The second demo was more complex. This demo actually showed you map data from the beginning of the collection to the most recent report. Watch the <a href="http://www.coldfusionjedi.com/demos/traffic.swf">video</a> if that doesn&rsquo;t make sense. Let&rsquo;s look at how I built that demo. (Warning: I&rsquo;m going to jump around a bit code wise but at the end I&rsquo;ll paste the entire template.)</p>

<p><p></p>

<p>I began with a map centered on my home town:</p>

<p><p></p>

<p><code>
&lt;cfmap centeraddress=&ldquo;Lafayette, LA&rdquo; width=&ldquo;500&rdquo; height=&ldquo;500&rdquo; zoomlevel=&ldquo;12&rdquo; showcentermarker=&ldquo;false&rdquo; name=&ldquo;mainMap&rdquo;&gt;
&lt;/cfmap&gt;
</code></p>

<p><p></p>

<p>I then created a DIV that would store the current time:</p>

<p><p></p>

<p><code>
&lt;div id=&ldquo;clock&rdquo;&gt;&lt;/div&gt;
</code></p>

<p><p></p>

<p>Next - I needed to tell ColdFusion to run a JavaScript function when everything (in this case, the map) was loaded. The last line of my script was:</p>

<p><p></p>

<p><code>
&lt;cfset ajaxOnLoad(&ldquo;init&rdquo;)&gt;
</code></p>

<p><p></p>

<p>This ran my init function. It&rsquo;s main purpose was to just set things up and run my main (and repeatable) function to display data.</p>

<p><p></p>

<p><code>
function init() {
    map = ColdFusion.Map.getMapObject(&ldquo;mainMap&rdquo;)
    doMarkers()
}
</code></p>

<p><p></p>

<p>I&rsquo;m using map there as a global variable. Remember that this is the &ldquo;real&rdquo; Google Map API object. When I have that I can do anything Google allows via their API. Let&rsquo;s look at doMarkers now.</p>

<p><p></p>

<p><code>
function doMarkers() {</p>

<pre><code>if(prevMarkers.length) {
    for(var i=0;i&amp;lt;prevMarkers.length;i++) {
        map.removeOverlay(prevMarkers[i])
    }
    prevMarkers = []
}

current++
var thisDate = bucketArray[current][&quot;date&quot;]
console.log(thisDate + ' has '+bucketArray[current].records.length +' items')
$(&quot;#clock&quot;).text(thisDate)
for(var i=0; i&amp;lt;bucketArray[current][&quot;records&quot;].length;i++) {
    var point = new GLatLng(bucketArray[current].records[i][&quot;latitude&quot;],bucketArray[current].records[i][&quot;longitude&quot;])
    var icon = getIcon(bucketArray[current].records[i][&quot;type&quot;])

    var iconOb = new GIcon(G_DEFAULT_ICON);
    if(icon != &quot;&quot;) iconOb.image = icon;
    var marker = new GMarker(point, {icon:iconOb})
    prevMarkers[prevMarkers.length]=marker
    map.addOverlay(marker)
}

if(current+1 &amp;lt; bucketArray.length) window.setTimeout(&quot;doMarkers()&quot;, 1000)
</code></pre>

<p>}
</code></p>

<p><p></p>

<p>Ok, a lot going on here. I begin by seeing if I have previous markers to delete. This will be true on the second iteration and will be true until the &ldquo;viewer&rdquo; is done. I&rsquo;ll end up storing my pointers in an array so I simply loop over that and run removeOverlay().</p>

<p><p></p>

<p>Next I work with a data structure called bucketArray. I&rsquo;m going to explain how that is built later, but for now, just know it stores a date/time value and a list of 911 data. This is already ordered by time already, so as we go through the array we are going through time. You can see where I update the time div. Then I loop through my data. For each I figure out if I need a custom icon, and if so, I set it up. I then add the marker to the map being sure to store the result in my prevMarkers array. The last line simply calls out to itself to run the next block of data.</p>

<p><p></p>

<p>My getIcon function just translates the 911 &ldquo;type&rdquo; into a custom icon:</p>

<p><p></p>

<p><code>
function getIcon(s) {
    s = s.toLowerCase()
    if(s.indexOf(&ldquo;vehicle accident&rdquo;) &gt;= 0) return &ldquo;icons/car.png&rdquo;;
    if(s.indexOf(&ldquo;stalled vehicle&rdquo;) &gt;= 0) return &ldquo;icons/car.png&rdquo;;
    if(s.indexOf(&ldquo;traffic control&rdquo;) &gt;= 0) return &ldquo;icons/stop.png&rdquo;;
    if(s.indexOf(&ldquo;traffic signal&rdquo;) &gt;= 0) return &ldquo;icons/stop.png&rdquo;;
    if(s.indexOf(&ldquo;fire&rdquo;) &gt;= 0) return &ldquo;icons/fire.png&rdquo;;
    if(s.indexOf(&ldquo;hazard&rdquo;) &gt;= 0) return &ldquo;icons/hazard.png&rdquo;;
    return &ldquo;&rdquo;;
}
</code></p>

<p><p></p>

<p>I could update this as more types of emergencies occur. I&rsquo;m still waiting for &ldquo;Giant Monster&rdquo; or &ldquo;Alien Invasion.&rdquo; For the most part, that&rsquo;s the gist of the JavaScript. So how did I create my data? I began with a query:</p>

<p><p></p>

<p><code>
&lt;cfquery name=&ldquo;getdata&rdquo;&gt;
select  longitude, latitude, type, incidenttime
from data
where
    (longitude !=&rdquo; and latitude != &ldquo;)
    &lt;!&mdash; fixes one bad row &mdash;&gt;
    and longitude &lt; -88
    and incidenttime is not null
    order by incidenttime asc
&lt;/cfquery&gt;
</code></p>

<p><p></p>

<p>I then figure out the range of my data:</p>

<p><p></p>

<p><code>
&lt;!&mdash; generate range of buckets &mdash;&gt;
&lt;cfset earliest = getdata.incidenttime[1]&gt;
&lt;cfset latest = getdata.incidenttime[getdata.recordcount]&gt;
&lt;cfset earliest = dateFormat(earliest, &ldquo;m/d/yy&rdquo;) &amp; &ldquo; &rdquo; &amp; timeFormat(earliest, &ldquo;H&rdquo;) &amp; &ldquo;:00&rdquo;&gt;
&lt;cfset latest = dateFormat(latest, &ldquo;m/d/yy&rdquo;) &amp; &ldquo; &rdquo; &amp; timeFormat(latest, &ldquo;H&rdquo;) &amp; &ldquo;:00&rdquo;&gt;
</code></p>

<p><p></p>

<p>Next I initialize my bucketArray:</p>

<p><p></p>

<p><code>
&lt;cfset bucketArray = []&gt;
&lt;cfloop from=&ldquo;#earliest#&rdquo; to=&ldquo;#latest#&rdquo; index=&ldquo;x&rdquo; step=&ldquo;#createTimeSpan(0,1,0,0)#&rdquo;&gt;
    &lt;cfset arrayAppend(bucketArray, {date=&ldquo;#dateformat(x)# #timeformat(x)#&rdquo;})&gt;
&lt;/cfloop&gt;
&lt;!&mdash; add one to top &mdash;&gt;
&lt;cfset toAppend = dateAdd(&ldquo;h&rdquo;, 1, bucketArray[arrayLen(bucketArray)].date)&gt;
&lt;cfset arrayAppend(bucketArray, {date=&ldquo;#dateFormat(toAppend)# #timeFormat(toAppend)#&rdquo;})&gt;
&lt;!&mdash; i&rsquo;m pretty sure it is safe to do this &mdash;&gt;
&lt;cfset arrayDeleteAt(bucketArray, 1)&gt;
</code></p>

<p><p></p>

<p>So what&rsquo;s with the &lsquo;add one to top&rsquo; and &lsquo;delete the bottom&rsquo;? My thinking here was - if my last 911 report was for 5:14PM, I wanted to have this reported as 6PM. Every time value you see represents all the values for the last hour. By the same token, if my first bucket item is 1PM, it really means an item for 1:Something PM. Therefore I can drop that as well.</p>

<p><p></p>

<p>The final step was to populate the data:</p>

<p><p></p>

<p><code>
&lt;cfloop index=&ldquo;b&rdquo; array=&ldquo;#bucketArray#&rdquo;&gt;
    &lt;cfset prev = dateAdd(&ldquo;h&rdquo;, -1, b.date)&gt;
    &lt;cfquery name=&ldquo;getInBucket&rdquo; dbtype=&ldquo;query&rdquo;&gt;
    select  *
    from    getdata
    where   incidenttime &gt;= &lt;cfqueryparam cfsqltype=&ldquo;cf_sql_timestamp&rdquo; value=&ldquo;#prev#&rdquo;&gt;
    and     incidenttime &lt; &lt;cfqueryparam cfsqltype=&ldquo;cf_sql_timestamp&rdquo; value=&ldquo;#b.date#&rdquo;&gt;
    &lt;/cfquery&gt;
    &lt;cfset b.records = getInBucket&gt;
&lt;/cfloop&gt;
</code></p>

<p><p></p>

<p>To be honest, I bet I could do this all in one cfquery, probably by simply reformatting the date. Either way - it worked. So how did I get this bucketArray into JavaScript? It was incredibly difficult:</p>

<p><p></p>

<p><code>
&lt;cfoutput&gt;
var #toScript(bucketArray,&ldquo;bucketArray&rdquo;,false)#;
&lt;/cfoutput&gt;
</code></p>

<p><p></p>

<p>Yeah, cry over that PHP boys. Anyway, here is the complete CFM file. I&rsquo;ll remind folks that I wrote this <i>very</i> quickly, so please forgive any obvious dumb mistakes.</p>

<p><p></p>

<p><code>
&lt;cfquery name=&ldquo;getdata&rdquo;&gt;
select  longitude, latitude, type, incidenttime
from data
where
    (longitude !=&rdquo; and latitude != &ldquo;)
    &lt;!&mdash; fixes one bad row &mdash;&gt;
    and longitude &lt; -88
    and incidenttime is not null
    order by incidenttime asc
&lt;/cfquery&gt;</p>

<p>&lt;!&mdash; generate range of buckets &mdash;&gt;
&lt;cfset earliest = getdata.incidenttime[1]&gt;
&lt;cfset latest = getdata.incidenttime[getdata.recordcount]&gt;
&lt;cfset earliest = dateFormat(earliest, &ldquo;m/d/yy&rdquo;) &amp; &ldquo; &rdquo; &amp; timeFormat(earliest, &ldquo;H&rdquo;) &amp; &ldquo;:00&rdquo;&gt;
&lt;cfset latest = dateFormat(latest, &ldquo;m/d/yy&rdquo;) &amp; &ldquo; &rdquo; &amp; timeFormat(latest, &ldquo;H&rdquo;) &amp; &ldquo;:00&rdquo;&gt;</p>

<p>&lt;cfset bucketArray = []&gt;
&lt;cfloop from=&ldquo;#earliest#&rdquo; to=&ldquo;#latest#&rdquo; index=&ldquo;x&rdquo; step=&ldquo;#createTimeSpan(0,1,0,0)#&rdquo;&gt;
    &lt;cfset arrayAppend(bucketArray, {date=&ldquo;#dateformat(x)# #timeformat(x)#&rdquo;})&gt;
&lt;/cfloop&gt;
&lt;!&mdash; add one to top &mdash;&gt;
&lt;cfset toAppend = dateAdd(&ldquo;h&rdquo;, 1, bucketArray[arrayLen(bucketArray)].date)&gt;
&lt;cfset arrayAppend(bucketArray, {date=&ldquo;#dateFormat(toAppend)# #timeFormat(toAppend)#&rdquo;})&gt;
&lt;!&mdash; i&rsquo;m pretty sure it is safe to do this &mdash;&gt;
&lt;cfset arrayDeleteAt(bucketArray, 1)&gt;</p>

<p>&lt;!&mdash;
&lt;cfloop index=&ldquo;index&rdquo; from=&ldquo;1&rdquo; to=&ldquo;#arrayLen(bucketArray)#&rdquo;&gt;
&mdash;&gt;
&lt;cfloop index=&ldquo;b&rdquo; array=&ldquo;#bucketArray#&rdquo;&gt;
    &lt;cfset prev = dateAdd(&ldquo;h&rdquo;, -1, b.date)&gt;
    &lt;cfquery name=&ldquo;getInBucket&rdquo; dbtype=&ldquo;query&rdquo;&gt;
    select  *
    from    getdata
    where   incidenttime &gt;= &lt;cfqueryparam cfsqltype=&ldquo;cf_sql_timestamp&rdquo; value=&ldquo;#prev#&rdquo;&gt;
    and     incidenttime &lt; &lt;cfqueryparam cfsqltype=&ldquo;cf_sql_timestamp&rdquo; value=&ldquo;#b.date#&rdquo;&gt;
    &lt;/cfquery&gt;
    &lt;cfset b.records = getInBucket&gt;
&lt;/cfloop&gt;
&lt;!&mdash;
&lt;cfdump var=&ldquo;#bucketarray#&rdquo;&gt;
&mdash;&gt;</p>

<p>&lt;html&gt;</p>

<p>&lt;head&gt;
&lt;script type=&ldquo;text/javascript&rdquo; src=&ldquo;<a href="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js&quot;&gt;&lt;/script&gt;">http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js&quot;&gt;&lt;/script&gt;</a>
&lt;script&gt;
&lt;cfoutput&gt;
var #toScript(bucketArray,&ldquo;bucketArray&rdquo;,false)#;
&lt;/cfoutput&gt;</p>

<p>var current = -1;
var mainHB;
var prevMarkers = []
var map;</p>

<p>function getIcon(s) {
    s = s.toLowerCase()
    if(s.indexOf(&ldquo;vehicle accident&rdquo;) &gt;= 0) return &ldquo;icons/car.png&rdquo;;
    if(s.indexOf(&ldquo;stalled vehicle&rdquo;) &gt;= 0) return &ldquo;icons/car.png&rdquo;;
    if(s.indexOf(&ldquo;traffic control&rdquo;) &gt;= 0) return &ldquo;icons/stop.png&rdquo;;
    if(s.indexOf(&ldquo;traffic signal&rdquo;) &gt;= 0) return &ldquo;icons/stop.png&rdquo;;
    if(s.indexOf(&ldquo;fire&rdquo;) &gt;= 0) return &ldquo;icons/fire.png&rdquo;;
    if(s.indexOf(&ldquo;hazard&rdquo;) &gt;= 0) return &ldquo;icons/hazard.png&rdquo;;
    return &ldquo;&rdquo;;
}</p>

<p>function doMarkers() {</p>

<pre><code>if(prevMarkers.length) {
    for(var i=0;i&amp;lt;prevMarkers.length;i++) {
        map.removeOverlay(prevMarkers[i])
    }
    prevMarkers = []
}

current++
var thisDate = bucketArray[current][&quot;date&quot;]
console.log(thisDate + ' has '+bucketArray[current].records.length +' items')
$(&quot;#clock&quot;).text(thisDate)
for(var i=0; i&amp;lt;bucketArray[current][&quot;records&quot;].length;i++) {
    var point = new GLatLng(bucketArray[current].records[i][&quot;latitude&quot;],bucketArray[current].records[i][&quot;longitude&quot;])
    var icon = getIcon(bucketArray[current].records[i][&quot;type&quot;])

    var iconOb = new GIcon(G_DEFAULT_ICON);
    if(icon != &quot;&quot;) iconOb.image = icon;
    var marker = new GMarker(point, {icon:iconOb})
    prevMarkers[prevMarkers.length]=marker
    map.addOverlay(marker)
}

if(current+1 &amp;lt; bucketArray.length) window.setTimeout(&quot;doMarkers()&quot;, 1000)
</code></pre>

<p>}</p>

<p>function init() {
    map = ColdFusion.Map.getMapObject(&ldquo;mainMap&rdquo;)
    doMarkers()
}
&lt;/script&gt;
&lt;style&gt;
#clock {
    font-weight:bold;
    font-size: 40px;
    font-family: &ldquo;Courier New&rdquo;, Courier, monospace;
}
&lt;/style&gt;
&lt;/head&gt;</p>

<p>&lt;body&gt;</p>

<p>&lt;cfmap centeraddress=&ldquo;Lafayette, LA&rdquo; width=&ldquo;500&rdquo; height=&ldquo;500&rdquo; zoomlevel=&ldquo;12&rdquo; showcentermarker=&ldquo;false&rdquo; name=&ldquo;mainMap&rdquo;&gt;
&lt;/cfmap&gt;</p>

<p>&lt;div id=&ldquo;clock&rdquo;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</p>

<p>&lt;cfset ajaxOnLoad(&ldquo;init&rdquo;)&gt;
</code></p>

            </div>
        </div>

    </article>

		
    <section id="comments">
        <div id="disqus_thread">
            
<script>
var disqus_config = function () {

this.page.url = 'http://www.raymondcamden.com\/2010\/01\/20\/Follow-up-to-CFMAPjQuery911-Demo'; 
this.page.identifier = '/?p=3690'; 

};

(function() { 
var d = document, s = d.createElement('script');

s.src = '//raymondcamden.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        </div>
    </section>
	
</section>

    <aside id="sidebar">

	<div class="widget-wrap">
		<h3 class="widget-title">
			Sponsors
		</h3>
		<div class="widget">
			<a href="http://www.fusion-reactor.com/?affiliate=raymondcamden"><img src="/images/frad150.png" title="FusionReactor"></a>
		</div>
	</div>

  	
    
<div class="widget-wrap">
    <h3 class="widget-title">
        Recents
    </h3>
    <div class="widget">
        <ul id="recent-post">
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.raymondcamden.com/2010/01/20/Follow-up-to-CFMAPjQuery911-Demo" class="thumbnail">
                    
                        <span style="background-image:url(http://www.raymondcamden.com//images/banners/comicbooks.jpg)" alt="Follow up to CFMAP/jQuery/911 Demo" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://www.raymondcamden.com/categories/development">
                        Development
                        </a>
                    </p>
                    
                    <p class="item-title"><a href="http://www.raymondcamden.com/2016/02/22/building-a-twitter-bot-to-display-random-comic-book-covers" class="title">Building a Twitter bot to display random comic book covers</a></p>
                    <p class="item-date">
                        <time datetime="2016-02-22 10:42:00 -0700 -0700" itemprop="datePublished">2016-02-22</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.raymondcamden.com/2010/01/20/Follow-up-to-CFMAPjQuery911-Demo" class="thumbnail">
                    
                        <span class="thumbnail-image thumbnail-none"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://www.raymondcamden.com/categories/development">
                        Development
                        </a>
                    </p>
                    
                    <p class="item-title"><a href="http://www.raymondcamden.com/2016/02/18/creating-an-unread-count-for-a-static-site" class="title">Creating an unread count for a static site</a></p>
                    <p class="item-date">
                        <time datetime="2016-02-18 14:23:00 -0700 -0700" itemprop="datePublished">2016-02-18</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.raymondcamden.com/2010/01/20/Follow-up-to-CFMAPjQuery911-Demo" class="thumbnail">
                    
                        <span style="background-image:url(http://www.raymondcamden.com//images/banners/phonegap-logo.png)" alt="Follow up to CFMAP/jQuery/911 Demo" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://www.raymondcamden.com/categories/development">
                        Development
                        </a>
                    </p>
                    
                    <p class="item-title"><a href="http://www.raymondcamden.com/2016/02/17/my-phonegap-day-2016-presentation" class="title">My PhoneGap Day 2016 Presentation</a></p>
                    <p class="item-date">
                        <time datetime="2016-02-17 08:41:00 -0700 -0700" itemprop="datePublished">2016-02-17</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.raymondcamden.com/2010/01/20/Follow-up-to-CFMAPjQuery911-Demo" class="thumbnail">
                    
                        <span class="thumbnail-image thumbnail-none"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://www.raymondcamden.com/categories/coldfusion">
                        ColdFusion
                        </a>
                    </p>
                    
                    <p class="item-title"><a href="http://www.raymondcamden.com/2016/02/16/adobe-coldfusion-2016-released" class="title">Adobe ColdFusion 2016 Released</a></p>
                    <p class="item-date">
                        <time datetime="2016-02-16 05:35:00 -0700 -0700" itemprop="datePublished">2016-02-16</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.raymondcamden.com/2010/01/20/Follow-up-to-CFMAPjQuery911-Demo" class="thumbnail">
                    
                        <span class="thumbnail-image thumbnail-none"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://www.raymondcamden.com/categories/misc">
                        Misc
                        </a>
                    </p>
                    
                    <p class="item-title"><a href="http://www.raymondcamden.com/2016/02/15/missing-devnexus" class="title">Missing DevNexus</a></p>
                    <p class="item-date">
                        <time datetime="2016-02-15 14:44:00 -0700 -0700" itemprop="datePublished">2016-02-15</time>
                    </p>
                </div>
            </li>
            
        </ul>
    </div>
</div>


    


<div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/adoption">
                    adoption
                </a>
                <span class="category-list-count">13</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/books">
                    books
                </a>
                <span class="category-list-count">39</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/coldfusion">
                    coldfusion
                </a>
                <span class="category-list-count">3128</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/design">
                    design
                </a>
                <span class="category-list-count">32</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/development">
                    development
                </a>
                <span class="category-list-count">706</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/flex">
                    flex
                </a>
                <span class="category-list-count">189</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/games">
                    games
                </a>
                <span class="category-list-count">5</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/html5">
                    html5
                </a>
                <span class="category-list-count">273</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/javascript">
                    javascript
                </a>
                <span class="category-list-count">592</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/jquery">
                    jquery
                </a>
                <span class="category-list-count">329</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/misc">
                    misc
                </a>
                <span class="category-list-count">1157</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/mobile">
                    mobile
                </a>
                <span class="category-list-count">458</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/movies">
                    movies
                </a>
                <span class="category-list-count">31</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/music">
                    music
                </a>
                <span class="category-list-count">10</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/uncategorized">
                    uncategorized
                </a>
                <span class="category-list-count">13</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/categories/video-games">
                    video-games
                </a>
                <span class="category-list-count">74</span>
            </li>
            
        </ul>
    </div>
</div>



    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tags
    </h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/bluemix">
                    bluemix
                </a>
                <span class="category-list-count">21</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/cordova">
                    cordova
                </a>
                <span class="category-list-count">51</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/front-end-interview-questions">
                    front-end-interview-questions
                </a>
                <span class="category-list-count">3</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/harpjs">
                    harpjs
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/ionic">
                    ionic
                </a>
                <span class="category-list-count">66</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/mobilefirst">
                    mobilefirst
                </a>
                <span class="category-list-count">25</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/nodejs">
                    nodejs
                </a>
                <span class="category-list-count">3</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/phonegap">
                    phonegap
                </a>
                <span class="category-list-count">2</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/strongloop">
                    strongloop
                </a>
                <span class="category-list-count">10</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.raymondcamden.com/tags/swift">
                    swift
                </a>
                <span class="category-list-count">1</span>
            </li>
            
        </ul>
    </div>
</div>



    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tag cloud
    </h3>
    <div class="widget tagcloud">
        
        <a href="http://www.raymondcamden.com/tags/bluemix" style="font-size: 12px;">bluemix</a>
        
        <a href="http://www.raymondcamden.com/tags/cordova" style="font-size: 12px;">cordova</a>
        
        <a href="http://www.raymondcamden.com/tags/front-end-interview-questions" style="font-size: 12px;">front-end-interview-questions</a>
        
        <a href="http://www.raymondcamden.com/tags/harpjs" style="font-size: 12px;">harpjs</a>
        
        <a href="http://www.raymondcamden.com/tags/ionic" style="font-size: 12px;">ionic</a>
        
        <a href="http://www.raymondcamden.com/tags/mobilefirst" style="font-size: 12px;">mobilefirst</a>
        
        <a href="http://www.raymondcamden.com/tags/nodejs" style="font-size: 12px;">nodejs</a>
        
        <a href="http://www.raymondcamden.com/tags/phonegap" style="font-size: 12px;">phonegap</a>
        
        <a href="http://www.raymondcamden.com/tags/strongloop" style="font-size: 12px;">strongloop</a>
        
        <a href="http://www.raymondcamden.com/tags/swift" style="font-size: 12px;">swift</a>
        
    </div>
</div>



	

    <div id="toTop" class="fa fa-chevron-up"></div>
</aside>

</div>
</div>

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016
      Powered by <a href="//gohugo.io">Hugo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>.
    </div>
  </div>
</footer>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-70863-1', 'auto');
ga('send', 'pageview');
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="http://www.raymondcamden.com/fancybox/jquery.fancybox.pack.js"></script>
<script src="http://www.raymondcamden.com/js/script.js"></script>
<script src="http://www.raymondcamden.com/js/prism.js"></script>


</body>
</html>
